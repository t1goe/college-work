{
  "$schema": "https://vega.github.io/schema/vega-lite/v4.json",
  "data": {
    "url": "https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-01-21/spotify_songs.csv",
    "format": {"type": "csv"}
  },
  "transform": [
    {
      "calculate": 
      "datum.duration_ms / 1000",
      "as": "duration_seconds"
    }
  ],
  "repeat":{
    "row":[
      "danceability",
      "energy",
      "key",
      "loudness",
      "mode",
      "speechiness",
      "acousticness",
      "instrumentalness",
      "liveness",
      "valence",
      "tempo",
      "duration_seconds"
    ]
  },
  "spec":{
    "mark":"bar",
    "encoding":{
      "x":{
        "field":{"repeat": "row"},
        "type":"quantitative",
        "aggregate":"mean"
      },
      "y":{
        "field":"playlist_genre",
        "type":"nominal",
        "sort":{
          "op":"mean",
          "field":{"repeat": "row"},
          "order":"descending"
        }
      },
      "color":{
        "field":"playlist_genre",
        "type":"nominal"
      }
    }
  }
}